# 阶段八：系统设置功能 - 进度文档

## 完成状态：已完成

## 任务完成情况

### 8.1 设置入口
- [x] 在 Header 组件添加设置图标按钮
- [x] 通过事件链传递到 App.vue 控制对话框

### 8.2 主题设置
- [x] 支持浅色/深色主题切换
- [x] 使用 appStore 管理主题状态
- [x] 主题设置持久化到 localStorage

### 8.3 数据存储路径
- [x] 显示当前数据存储位置
- [x] 支持选择新的存储位置（通过系统文件夹选择对话框）
- [x] 更换位置时提供迁移选项（迁移数据 / 不迁移）
- [x] 使用 config.yaml 存储自定义数据路径配置
- [x] 应用启动时从 config.yaml 加载数据路径

## 相关提交

- feat: 实现系统设置功能

## 文件变更

### 新增文件
- src/components/settings/SettingsDialog.vue
- src-tauri/src/commands/settings.rs

### 修改文件
- src/App.vue - 添加设置对话框
- src/components/layout/Header.vue - 添加设置按钮
- src/components/layout/AppLayout.vue - 添加设置事件传递
- src-tauri/src/commands/mod.rs - 添加 settings 模块
- src-tauri/src/lib.rs - 注册设置命令
- src-tauri/src/db/mod.rs - 添加 AppConfig 支持自定义数据路径
- src-tauri/Cargo.toml - 添加 tauri-plugin-dialog 依赖

## 技术要点

### 数据路径优先级
1. 首先检查 config.yaml 中的自定义路径
2. 如果没有自定义路径，使用默认的应用数据目录

### 数据迁移流程
1. 用户选择新目录
2. 弹窗询问是否迁移数据
3. 如果选择迁移：复制 data.yaml 到新目录
4. 更新 config.yaml 中的 data_path
5. 提示用户重启应用生效

## 测试要点

1. 主题切换：验证浅色/深色主题正确应用
2. 数据路径修改：验证可以成功选择新目录
3. 数据迁移：验证数据正确复制到新目录
4. 重启后验证：验证自定义数据路径正确加载
